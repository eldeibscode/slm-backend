# =============================================================================
# MYSQL DATABASE CONFIGURATION (Production)
# =============================================================================
# For Docker/Container deployments:
# - Database URL, username, and password are injected via environment variables
# - See docker-compose.yml and .env file for configuration
#
# For Traditional deployments:
# 1. Install MySQL Server
# 2. Create database: CREATE DATABASE slmdb CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
# 3. Create user: CREATE USER 'slm_user'@'localhost' IDENTIFIED BY 'your_secure_password';
# 4. Grant privileges: GRANT ALL PRIVILEGES ON slmdb.* TO 'slm_user'@'localhost';
# 5. Flush privileges: FLUSH PRIVILEGES;
# =============================================================================

# Database connection (supports environment variable override)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:mysql://localhost:3306/slmdb?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:slm_user}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:change_me_to_secure_password}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# MySQL Connection Pool Settings
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000

# JPA/Hibernate Configuration for MySQL
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
# Changed from 'validate' to 'update' to auto-create tables on first deployment
# Use 'validate' after initial deployment to prevent accidental schema changes
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# MySQL Specific Properties
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# Disable H2 Console in Production
spring.h2.console.enabled=false

# =============================================================================
# JWT CONFIGURATION
# =============================================================================
# Supports environment variable override for container deployments
jwt.secret=${JWT_SECRET:your-very-secure-secret-key-that-is-at-least-256-bits-long-for-hs256-algorithm-please-change-this-in-production}
jwt.expiration=${JWT_EXPIRATION:86400000}

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
# Comma-separated list of allowed origins (supports environment variable override)
# For production, set via CORS_ALLOWED_ORIGINS environment variable
# Supports wildcards: https://*.biedle.com will match all subdomains
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://biedle.com,http://biedle.com,https://*.biedle.com}

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
# File upload settings (supports environment variable override)
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB
app.upload.base-dir=${APP_UPLOAD_BASE_DIR:./uploads}
app.upload.path=${APP_UPLOAD_PATH:reports/}
app.upload.url-prefix=${APP_UPLOAD_URL_PREFIX:http://localhost:3000}

# Logging for Production
logging.level.root=WARN
logging.level.com.slm.backend=INFO
logging.level.org.hibernate.SQL=WARN
